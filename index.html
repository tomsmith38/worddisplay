<!DOCTYPE html>
<html>
<head>
  <title>Particles Text Effects</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #000; /* è¨­å®šèƒŒæ™¯é¡è‰²ç‚ºé»‘è‰² */
      font-family: 'Roboto', sans-serif; /* ä½¿ç”¨ Google Fonts çš„ Roboto å­—é«” */
    }
    canvas {
      display: block; /* éš±è—æ»¾å‹•æ¢ */
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <script>
    // å®šç¾©ä¸€äº›å…¨åŸŸè®Šæ•¸
    let particles = []; // å„²å­˜ç²’å­çš„é™£åˆ—
    let pixelSteps = 9; // è¨­å®šåƒç´ é–“è·
    let drawAsPoints = false; // ç”¨ä¾†åˆ‡æ›ç¹ªè£½æ–¹å¼
    let words = []; // å„²å­˜æ–‡å­—çš„é™£åˆ—
    let wordIndex = 0; // è¿½è¹¤ç›®å‰çš„æ–‡å­—ç´¢å¼•
    let bgColor; // èƒŒæ™¯é¡è‰²è®Šæ•¸

    function setup() {
      createCanvas(1200, 400); // å‰µå»ºç•«å¸ƒ
      bgColor = color(255, 100); // è¨­å®šèƒŒæ™¯é¡è‰²ç‚ºåŠé€æ˜ç™½è‰²
      // æ·»åŠ è¦é¡¯ç¤ºçš„æ–‡å­—
      words.push("ğŸŒ•æ˜æœˆç…§æ»¿ä¸­ç§‹å¤œ");
      words.push("ç¥å¤§å®¶ä¸­ç§‹ç¯€å¿«æ¨‚ğŸ‰ğŸ‚");
      words.push("åœ˜åœ“æ™‚å…‰æš–äººå¿ƒ");
      words.push("æ­¡èšä¸€å ‚æ¨‚ç„¡çª®");
      words.push("å¦‚èŠ±å¥½æœˆåœ“ï¼Œå¹¸ç¦ç¾æ»¿é•·ç›¸ä¼´");
      words.push("æœˆåœ“äººåœ“ï¼Œå¿ƒä¸­æ»¿æ˜¯å–œæ‚…ğŸ’–ğŸ˜Š");
      nextWord(words[wordIndex]); // é¡¯ç¤ºç¬¬ä¸€å€‹æ–‡å­—
    }

    function draw() {
      fill(bgColor); // è¨­å®šå¡«å……é¡è‰²
      noStroke(); // ä¸æé‚Š
      rect(0, 0, width * 2, height * 2); // ç¹ªè£½èƒŒæ™¯çŸ©å½¢

      // é€ä¸€è™•ç†æ¯å€‹ç²’å­
      for (let x = particles.length - 1; x > -1; x--) {
        let particle = particles[x];
        particle.move(); // ç§»å‹•ç²’å­
        particle.draw(); // ç¹ªè£½ç²’å­

        // å¦‚æœç²’å­è¶…å‡ºé‚Šç•Œï¼Œå°‡å…¶ç§»é™¤
        if (particle.isKilled) {
          if (particle.pos.x < 0 || particle.pos.x > width || particle.pos.y < 0 || particle.pos.y > height) {
            particles.splice(x, 1); // ç§»é™¤ç²’å­
          }
        }
      }

      fill(255 - red(bgColor)); // è¨­å®šæç¤ºæ–‡å­—é¡è‰²ç‚ºèƒŒæ™¯é¡è‰²çš„å°æ¯”è‰²
      textSize(9); // è¨­å®šæç¤ºæ–‡å­—å¤§å°
      let tipText = `
      å·¦éµé»æ“Šé¡¯ç¤ºä¸‹ä¸€å€‹æ–‡å­—ã€‚
      å³éµæ‹–æ›³èˆ‡ç²’å­äº’å‹•ã€‚
      æŒ‰ä»»æ„éµåˆ‡æ›ç¹ªè£½æ–¹å¼ã€‚
      Particles text effects
      by Jason Labbe
      CC Attribution ShareAlike
      åŸå§‹å…§å®¹éˆæ¥ï¼šhttp://openprocessing.org/sketch/377231
      `;
      
      text(tipText, 10, height - 60); // åœ¨ç•«å¸ƒåº•éƒ¨é¡¯ç¤ºæç¤ºæ–‡å­—
      }

    function mousePressed() {
      if (mouseButton === LEFT) {
        wordIndex++; // åˆ‡æ›åˆ°ä¸‹ä¸€å€‹æ–‡å­—
        if (wordIndex > words.length - 1) {
          wordIndex = 0; // å¦‚æœå·²åˆ°æœ€å¾Œä¸€å€‹æ–‡å­—ï¼Œè¿”å›åˆ°ç¬¬ä¸€å€‹
        }
        nextWord(words[wordIndex]); // é¡¯ç¤ºæ–°çš„æ–‡å­—
      }
    }

    function mouseDragged() {
      if (mouseButton === RIGHT) {
        for (let particle of particles) {
          if (dist(particle.pos.x, particle.pos.y, mouseX, mouseY) < 50) {
            particle.kill(); // å¦‚æœç²’å­è·é›¢æ»‘é¼ ä½ç½®å°æ–¼50ï¼Œå°‡å…¶ã€Œæ®ºæ­»ã€
          }
        }
      }
    }

    function keyPressed() {
      drawAsPoints = !drawAsPoints; // åˆ‡æ›ç¹ªè£½æ–¹å¼
      if (drawAsPoints) {
        background(0); // é»‘è‰²èƒŒæ™¯
        bgColor = color(0, 40); // åŠé€æ˜é»‘è‰²èƒŒæ™¯
      } else {
        background(255); // ç™½è‰²èƒŒæ™¯
        bgColor = color(255, 100); // åŠé€æ˜ç™½è‰²èƒŒæ™¯
      }
    }

    class Particle {
      constructor() {
        this.pos = createVector(0, 0); // ç²’å­çš„ä½ç½®
        this.vel = createVector(0, 0); // ç²’å­çš„é€Ÿåº¦
        this.acc = createVector(0, 0); // ç²’å­çš„åŠ é€Ÿåº¦
        this.target = createVector(0, 0); // ç²’å­çš„ç›®æ¨™ä½ç½®
        this.closeEnoughTarget = 50; // æ¥è¿‘ç›®æ¨™çš„è·é›¢
        this.maxSpeed = random(2.0, 5.0); // æœ€å¤§é€Ÿåº¦
        this.maxForce = this.maxSpeed * 0.025; // æœ€å¤§åŠ›
        this.particleSize = random(3, 6); // ç²’å­çš„å¤§å°
        this.isKilled = false; // ç²’å­æ˜¯å¦è¢«ã€Œæ®ºæ­»ã€
        this.startColor = color(0); // åˆå§‹é¡è‰²
        this.targetColor = color(0); // ç›®æ¨™é¡è‰²
        this.colorWeight = 0; // é¡è‰²æ¼¸è®Šçš„æ¬Šé‡
        this.colorBlendRate = random(0.0025, 0.03); // é¡è‰²æ¼¸è®Šé€Ÿç‡
      }

      move() {
        let proximityMult = 1.0;
        let distance = dist(this.pos.x, this.pos.y, this.target.x, this.target.y);
        if (distance < this.closeEnoughTarget) {
          proximityMult = distance / this.closeEnoughTarget;
        }

        let towardsTarget = createVector(this.target.x, this.target.y);
        towardsTarget.sub(this.pos);
        towardsTarget.normalize();
        towardsTarget.mult(this.maxSpeed * proximityMult);

        let steer = createVector(towardsTarget.x, towardsTarget.y);
        steer.sub(this.vel);
        steer.normalize();
        steer.mult(this.maxForce);
        this.acc.add(steer);

        this.vel.add(this.acc);
        this.pos.add(this.vel);
        this.acc.mult(0);
      }

      draw() {
        let currentColor = lerpColor(this.startColor, this.targetColor, this.colorWeight);
        if (drawAsPoints) {
          stroke(currentColor);
          point(this.pos.x, this.pos.y);
        } else {
          noStroke();
          fill(currentColor);
          ellipse(this.pos.x, this.pos.y, this.particleSize, this.particleSize);
        }

        if (this.colorWeight < 1.0) {
          this.colorWeight = min(this.colorWeight + this.colorBlendRate, 1.0);
        }
      }

      kill() {
        if (!this.isKilled) {
          let randomPos = generateRandomPos(width / 2, height / 2, (width + height) / 2);
          this.target.x = randomPos.x;
          this.target.y = randomPos.y;

          this.startColor = lerpColor(this.startColor, this.targetColor, this.colorWeight);
          this.targetColor = color(0);
          this.colorWeight = 0;

          this.isKilled = true;
        }
      }
    }

    function generateRandomPos(x, y, mag) {
      let randomDir = createVector(random(0, width), random(0, height));
      let pos = createVector(x, y);
      pos.sub(randomDir);
      pos.normalize();
      pos.mult(mag);
      pos.add(x, y);
      return pos;
    }

function nextWord(word) {
  // å‰µå»ºä¸€å€‹ PGraphics å°è±¡ä¾†é€²è¡Œç¹ªåœ–
  let pg = createGraphics(width, height);
  pg.background(255); // è¨­ç½®èƒŒæ™¯
  pg.fill(0); // è¨­ç½®æ–‡å­—é¡è‰²
  pg.textSize(90); // è¨­ç½®æ–‡å­—å¤§å°
  pg.textAlign(CENTER); // è¨­ç½®æ–‡å­—å°é½Š

  // ä½¿ç”¨ Google Fonts å­—é«”
  textFont('Roboto'); // ä½¿ç”¨ Google Fonts åŠ è¼‰å­—é«”
  
  // å¦‚æœéœ€è¦ï¼Œé€™è£¡å¯ä»¥æ·»åŠ æ›´å¤šå­—é«”é¸é …
  // textFont('sans-serif'); // å¦‚æœç„¡æ³•åŠ è¼‰ç¶²çµ¡å­—é«”ï¼Œæœƒé€€å›åˆ°ç³»çµ±é»˜èªå­—é«”

  pg.text(word, width / 2, height / 2); // åœ¨ç•«å¸ƒä¸­å¤®ç¹ªè£½æ–‡å­—
  pg.loadPixels(); // åŠ è¼‰åƒç´ æ•¸æ“š

  // è¨­ç½®æ–°é¡è‰²
  let newColor = color(random(0, 255), random(0, 255), random(0, 255));

  let particleCount = particles.length;
  let particleIndex = 0;

  // æ”¶é›†åæ¨™æ•¸æ“š
  let coordsIndexes = [];
  for (let i = 0; i < (width * height) - 1; i += pixelSteps) {
    coordsIndexes.push(i);
  }

  for (let i = 0; i < coordsIndexes.length; i++) {
    let randomIndex = int(random(0, coordsIndexes.length));
    let coordIndex = coordsIndexes[randomIndex];
    coordsIndexes.splice(randomIndex, 1);

    if (pg.pixels[coordIndex * 4] != 255) { // ç¢ºèªåƒç´ ä¸æ˜¯ç™½è‰²
      let x = coordIndex % width;
      let y = int(coordIndex / width);

      let newParticle;

      if (particleIndex < particleCount) {
        newParticle = particles[particleIndex];
        newParticle.isKilled = false;
        particleIndex++;
      } else {
        newParticle = new Particle();
        let randomPos = generateRandomPos(width / 2, height / 2, (width + height) / 2);
        newParticle.pos.set(randomPos);
        newParticle.maxSpeed = random(2.0, 5.0);
        newParticle.maxForce = newParticle.maxSpeed * 0.025;
        newParticle.particleSize = random(3, 6);
        newParticle.colorBlendRate = random(0.0025, 0.03);
        particles.push(newParticle);
      }

      newParticle.startColor = lerpColor(newParticle.startColor, newParticle.targetColor, newParticle.colorWeight);
      newParticle.targetColor = newColor;
      newParticle.colorWeight = 0;
      newParticle.target.set(x, y);
    }
  }

  if (particleIndex < particleCount) {
    for (let i = particleIndex; i < particleCount; i++) {
      let particle = particles[i];
      particle.kill();
    }
  }
}

  </script>
</body>
</html>
